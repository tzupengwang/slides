<pre><code class="c++" data-trim contenteditable>int main() {
  dq.push_back( (line){ 0 , 0 } ) ;
  for ( int i = 1 ; i <= n ; i ++ ) {
    while ( dq.size() >= 2 && dq[ 0 ].value( g( i ) )
        < dq[ 1 ].value( g( i ) ) )
      dq.pop_front() ;
    dp[ i ] = dq[ 0 ].value( g( i ) ) + t( i ) ;
    line newline{ h( i ) , f( i ) } ;
    while ( dq.size() >= 2 &&
        check( dq[ dq.size() - 2 ] , dq[ dq.size() - 1 ] , newline ) )
      dq.pop_back() ;
    dq.push_back( newline ) ;
  }
}
</code></pre>

