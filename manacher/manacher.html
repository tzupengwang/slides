<pre><code data-trim contenteditable>
#define MAXN 100010
char s[ MAXN ] , tmp[ MAXN * 2 ] ;
int rad[ MAXN * 2 ] , N;
void manacher()
{
  for ( int i = 0 ; i < N * 2 + 1 ; i ++ ) tmp[ i ] = '#' ;
  for ( int i = 0 ; i < N ; i ++ ) tmp[ i * 2 + 1 ] = s[ i ] ;
  int i = 0 , j = 0 , n = N * 2 + 1 ;
  while ( i < n ) {
	while ( i - j >= 0 && i + j < n && tmp[ i - j ] == tmp[ i + j ] ) j ++ ;
	rad[ i ] = j ;
	int k = 1 ;
	while ( rad[ i - k ] < rad[ i ] - k ) rad[ i + k ] = rad[ i - k ] , k ++ ;
	i += k ;
	j = max( 0 , j - k ) ;
  }
}
</code></pre>
